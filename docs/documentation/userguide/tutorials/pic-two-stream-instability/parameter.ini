! =============================================================================== !
! DISCRETIZATION
! =============================================================================== !
N                           = 7
! =============================================================================== !
! MESH
! =============================================================================== !
MeshFile                    = two_stream_instability_mesh.h5
useCurveds                  = F
! =============================================================================== !
! General
! =============================================================================== !
ProjectName                 = two_stream_instability
Logging                     = F
WriteErrorFiles             = F
TrackingMethod              = refmapping
doPrintStatusLine           = T                           ! Output live of ETA

! =============================================================================== !
! CALCULATION
! =============================================================================== !
ManualTimeStep              = 0.1
tend                        = 5e1
Analyze_dt                  = 0.5
IterDisplayStep             = 10
! =============================================================================== !
! PARTICLE Boundary Conditions
! =============================================================================== !
Part-nBounds                = 6
Part-Boundary1-SourceName   = BC_periodicx+
Part-Boundary1-Condition    = periodic
Part-Boundary2-SourceName   = BC_periodicx-
Part-Boundary2-Condition    = periodic
Part-Boundary3-SourceName   = BC_periodicy+
Part-Boundary3-Condition    = periodic
Part-Boundary4-SourceName   = BC_periodicy-
Part-Boundary4-Condition    = periodic
Part-Boundary5-SourceName   = BC_periodicz+
Part-Boundary5-Condition    = periodic
Part-Boundary6-SourceName   = BC_periodicz-
Part-Boundary6-Condition    = periodic

Part-nPeriodicVectors       = 3
Part-PeriodicVector1        = (/12.5663706144 , 0. , 0./)
Part-PeriodicVector2        = (/0. , 1. , 0./)
Part-PeriodicVector3        = (/0. , 0. , 1./)

Part-FIBGMdeltas            = (/12.5663706144 , 1. , 1./)
Part-FactorFIBGM            = (/1.            , 1. , 1./)

! =============================================================================== !
! HDGSEM
! =============================================================================== !
epsCG                       = 1e-12
maxIterCG                   = 1000
IniExactFunc                = 0

! =============================================================================== !
! PIC: Interpolation/Deposition
! =============================================================================== !
PIC-DoInterpolation         = T
PIC-Interpolation-Type      = particle_position

PIC-Deposition-Type         = shape_function
PIC-shapefunction-radius    = 0.5
PIC-shapefunction-dimension = 1
PIC-shapefunction-direction = 1
PIC-shapefunction-alpha     = 10
PIC-shapefunction-3D-deposition = F

c0  = 1.e8
eps = 1.
mu  = 1.e-16

! =============================================================================== !
! PARTICLE Emission
! =============================================================================== !
Part-maxParticleNumber      = 40101
Part-nSpecies               = 3

Part-Species1-MacroParticleFactor       = 1e6
Part-Species2-MacroParticleFactor       = 1e6 
Part-Species3-MacroParticleFactor       = 1e6
Part-Species1-Init1-ParticleNumber      = 9000
Part-Species1-Init1-maxParticleNumber-x = 9000
Part-Species2-Init1-ParticleNumber      = 9000
Part-Species2-Init1-maxParticleNumber-x = 9000
Part-Species3-Init1-ParticleNumber      = 9000
Part-Species3-Init1-maxParticleNumber-x = 9000

! ------------------------------------------------------------------------------- !
! Electrons 1
! ------------------------------------------------------------------------------- !
Part-Species1-ChargeIC                   = -1.602e-19
Part-Species1-MassIC                     = 9.109e-31
Part-Species1-nInits                     = 1

Part-Species1-Init1-SpaceIC              =line_with_equidistant_distribution
Part-Species1-Init1-BasePointIC          =(/0.,0.,0./)
Part-Species1-Init1-BaseVector2IC        =(/1.0,0.,0./)
Part-Species1-Init1-NormalIC             =(/0.,1.0,0.0/)
Part-Species1-Init1-velocityDistribution = maxwell_distribution_1D
Part-Species1-Init1-MWTemperatureIC      = 0.72429730341e23
Part-Species1-Init1-maxParticleNumber-y  = 1
Part-Species1-Init1-maxParticleNumber-z  = 1                                
Part-Species1-Init1-VeloIC               = 1.06e-8
Part-Species1-Init1-VeloVecIC            = (/1.,0.,0./)

Part-Species1-Init1-SpaceIC              =point
Part-Species1-Init1-BasePointIC          =(/0.,0.,0./)
Part-Species1-Init1-BaseVector2IC        =(/1.0,0.,0./)
Part-Species1-Init1-NormalIC             =(/0.,1.0,0.0/)


! ------------------------------------------------------------------------------- !
! Electrons 2
! ------------------------------------------------------------------------------- !
Part-Species2-ChargeIC                   = -1.602e-19
Part-Species2-MassIC                     = 9.109e-31

Part-Species2-nInits                     = 1

Part-Species2-Init1-SpaceIC              =line_with_equidistant_distribution
Part-Species2-Init1-SpaceIC              =point
Part-Species2-Init1-BasePointIC          =(/0.,0.,0./)
Part-Species2-Init1-BaseVector2IC        =(/1.0,0.,0./)
Part-Species2-Init1-NormalIC             =(/0.,1.0,0.0/)
Part-Species2-Init1-velocityDistribution = maxwell_distribution_1D
Part-Species2-Init1-MWTemperatureIC      = 0.72429730341e23
Part-Species2-Init1-maxParticleNumber-y  = 1
Part-Species2-Init1-maxParticleNumber-z  = 1
Part-Species2-Init1-Amplitude            = 0.004
Part-Species2-Init1-WaveNumber           = 0.5
Part-Species2-Init1-VeloIC               = -1.06e-8
Part-Species2-Init1-VeloVecIC            = (/-1.,0.,0./)


! ------------------------------------------------------------------------------- !
! Ions 3
! ------------------------------------------------------------------------------- !
Part-Species3-ChargeIC                   = 3.204e-19
Part-Species3-MassIC                     = 6.69e-27

Part-Species3-nInits                     = 1

Part-Species3-Init1-SpaceIC              =line_with_equidistant_distribution
Part-Species3-Init1-SpaceIC              =point
Part-Species3-Init1-BasePointIC          =(/0.,0.,0./)
Part-Species3-Init1-BaseVector2IC        =(/1.0,0.,0./)
Part-Species3-Init1-NormalIC             =(/0.,1.0,0.0/)
Part-Species3-Init1-velocityDistribution = constant
Part-Species3-Init1-maxParticleNumber-y  = 1
Part-Species3-Init1-maxParticleNumber-z  = 1
Part-Species3-Init1-Amplitude            = 0.0
Part-Species3-Init1-WaveNumber           = 0.
Part-Species3-Init1-VeloIC               = 0.0
Part-Species3-Init1-VeloVecIC            = (/0.,0.,0./)

! =============================================================================== !
! Analysis
! =============================================================================== !
CalcCharge               = T ! writes rel/abs charge error to PartAnalyze.csv
CalcPotentialEnergy      = T ! writes the potential field energy to FieldAnalyze.csv
CalcKineticEnergy        = T ! writes the kinetic energy of all particle species to PartAnalyze.csv
PIC-OutputSource         = T ! writes the deposited charge (RHS of Poisson's equation to XXX_State_000.0000XXX.h5)
CalcPICTimeStep          = T ! writes the PIC time step restriction to XXX_State_000.0000XXX.h5 (rule of thumb)
CalcPointsPerDebyeLength = T ! writes the PIC grid step restriction to XXX_State_000.0000XXX.h5 (rule of thumb)
CalcTotalEnergy          = T ! writes the total energy of the system to PartAnalyze.csv (field and particle)

! =============================================================================== !
! piclas2vtk
! =============================================================================== !
NVisu         = 10
VisuParticles = T

TimeStampLength=5
