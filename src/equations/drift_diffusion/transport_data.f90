!==================================================================================================================================
! Copyright (c) 2010 - 2018 Prof. Claus-Dieter Munz and Prof. Stefanos Fasoulas
!
! This file is part of PICLas (piclas.boltzplatz.eu/piclas/piclas). PICLas is free software: you can redistribute it and/or modify
! it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3
! of the License, or (at your option) any later version.
!
! PICLas is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty
! of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License v3.0 for more details.
!
! You should have received a copy of the GNU General Public License along with PICLas. If not, see <http://www.gnu.org/licenses/>.
!==================================================================================================================================
#include "piclas.h"


MODULE MOD_Transport_Data
! MODULES
IMPLICIT NONE
PRIVATE

!----------------------------------------------------------------------------------------------------------------------------------
! GLOBAL VARIABLES
!----------------------------------------------------------------------------------------------------------------------------------

PUBLIC::CalcDriftDiffusionCoeffH2,CalcDriftDiffusionCoeffAr,CalcIonizationRateAr,CalcDriftDiffusionCoeffNe,CalcIonizationRateNe
PUBLIC::CalcDriftDiffusionCoeffHe,CalcIonizationRateHe
!==================================================================================================================================
CONTAINS

SUBROUTINE CalcIonizationRateHe(ElectricField,Density,ionRate)
!==================================================================================================================================
!> Calculate the transport (drift & diffusion) coefficients for the drift-diffusion electron fluid model
! LXCat BOLSIG+ Helium
! Townsend ioniz. coef. alpha/N (m2)
!==================================================================================================================================
! MODULES
USE MOD_PreProc ! PP_N
! IMPLICIT VARIABLE HANDLING
IMPLICIT NONE
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT VARIABLES
REAL,INTENT(IN)                                  :: ElectricField, Density
!-----------------------------------------------------------------------------------------------------------------------------------
! OUTPUT VARIABLES
REAL,INTENT(OUT)                                 :: ionRate
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT / OUTPUT VARIABLES
!-----------------------------------------------------------------------------------------------------------------------------------
! LOCAL VARIABLES
REAL                                             :: Table(2,100), ReducedElectricField
!===================================================================================================================================

Table(1,:) = (/0.001,&
0.00115,&
0.001322,&
0.00152,&
0.001748,&
0.002009,&
0.00231,&
0.002656,&
0.003054,&
0.003511,&
0.004037,&
0.004642,&
0.005337,&
0.006136,&
0.007055,&
0.008111,&
0.009326,&
0.01072,&
0.01233,&
0.01417,&
0.0163,&
0.01874,&
0.02154,&
0.02477,&
0.02848,&
0.03275,&
0.03765,&
0.04329,&
0.04977,&
0.05722,&
0.06579,&
0.07565,&
0.08697,&
0.1,&
0.115,&
0.1322,&
0.152,&
0.1748,&
0.2009,&
0.231,&
0.2656,&
0.3054,&
0.3511,&
0.4037,&
0.4642,&
0.5337,&
0.6136,&
0.7055,&
0.8111,&
0.9326,&
1.072,&
1.233,&
1.417,&
1.63,&
1.874,&
2.154,&
2.477,&
2.848,&
3.275,&
3.765,&
4.329,&
4.977,&
5.722,&
6.579,&
7.565,&
8.697,&
10.,&
11.5,&
13.22,&
15.2,&
17.48,&
20.09,&
23.1,&
26.56,&
30.54,&
35.11,&
40.37,&
46.42,&
53.37,&
61.36,&
70.55,&
81.11,&
93.26,&
107.2,&
123.3,&
141.7,&
163.,&
187.4,&
215.4,&
247.7,&
284.8,&
327.5,&
376.5,&
432.9,&
497.7,&
572.2,&
657.9,&
756.5,&
869.7,&
1000./)

Table(2,:) = (/0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
4.6E-30,&
1.855E-28,&
3.102E-27,&
2.61E-26,&
1.333E-25,&
4.806E-25,&
1.364E-24,&
3.269E-24,&
6.913E-24,&
1.328E-23,&
2.366E-23,&
3.961E-23,&
6.3E-23,&
9.595E-23,&
1.409E-22,&
2.003E-22,&
2.773E-22,&
3.747E-22,&
4.958E-22,&
6.441E-22,&
8.227E-22,&
1.035E-21,&
1.283E-21,&
1.57E-21,&
1.895E-21,&
2.258E-21,&
2.655E-21,&
3.08E-21,&
3.522E-21,&
3.972E-21,&
4.414E-21,&
4.837E-21,&
5.226E-21,&
5.569E-21,&
5.853E-21,&
6.068E-21,&
6.202E-21,&
6.246E-21,&
6.191E-21/)

IF (Density.GT.0.) THEN
  ReducedElectricField=1.e21*ElectricField/Density ! E/n in Townsend as defined in LXCAT database
  ionRate = InterpolateCoefficient(Table,ReducedElectricField)*Density !Townsend ioniz. coef. alpha/N (m2)
END IF

END SUBROUTINE CalcIonizationRateHe

SUBROUTINE CalcDriftDiffusionCoeffHe(ElectricField,Density,mu,D)
!==================================================================================================================================
!> Calculate the transport (drift & diffusion) coefficients for the drift-diffusion electron fluid model
! LXCat BOLSIG+ Helium
!==================================================================================================================================
! MODULES
USE MOD_PreProc ! PP_N
! IMPLICIT VARIABLE HANDLING
IMPLICIT NONE
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT VARIABLES
REAL,INTENT(IN)                                  :: ElectricField, Density
!-----------------------------------------------------------------------------------------------------------------------------------
! OUTPUT VARIABLES
REAL,INTENT(OUT)                                 :: mu, D
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT / OUTPUT VARIABLES
!-----------------------------------------------------------------------------------------------------------------------------------
! LOCAL VARIABLES
REAL                                             :: EnergyTable(2,100), muTable(2,100), ReducedElectricField
!===================================================================================================================================
mu= 0.
D = 0.

EnergyTable(1,:) = (/0.001,&
0.00115,&
0.001322,&
0.00152,&
0.001748,&
0.002009,&
0.00231,&
0.002656,&
0.003054,&
0.003511,&
0.004037,&
0.004642,&
0.005337,&
0.006136,&
0.007055,&
0.008111,&
0.009326,&
0.01072,&
0.01233,&
0.01417,&
0.0163,&
0.01874,&
0.02154,&
0.02477,&
0.02848,&
0.03275,&
0.03765,&
0.04329,&
0.04977,&
0.05722,&
0.06579,&
0.07565,&
0.08697,&
0.1,&
0.115,&
0.1322,&
0.152,&
0.1748,&
0.2009,&
0.231,&
0.2656,&
0.3054,&
0.3511,&
0.4037,&
0.4642,&
0.5337,&
0.6136,&
0.7055,&
0.8111,&
0.9326,&
1.072,&
1.233,&
1.417,&
1.63,&
1.874,&
2.154,&
2.477,&
2.848,&
3.275,&
3.765,&
4.329,&
4.977,&
5.722,&
6.579,&
7.565,&
8.697,&
10.,&
11.5,&
13.22,&
15.2,&
17.48,&
20.09,&
23.1,&
26.56,&
30.54,&
35.11,&
40.37,&
46.42,&
53.37,&
61.36,&
70.55,&
81.11,&
93.26,&
107.2,&
123.3,&
141.7,&
163.,&
187.4,&
215.4,&
247.7,&
284.8,&
327.5,&
376.5,&
432.9,&
497.7,&
572.2,&
657.9,&
756.5,&
869.7,&
1000./)

EnergyTable(2,:) =(/0.03879,&
0.0388,&
0.03881,&
0.03882,&
0.03883,&
0.03884,&
0.03886,&
0.03889,&
0.03893,&
0.03897,&
0.03904,&
0.03912,&
0.03922,&
0.03936,&
0.03954,&
0.03977,&
0.04007,&
0.04045,&
0.04093,&
0.04154,&
0.0423,&
0.04324,&
0.04441,&
0.04583,&
0.04755,&
0.04963,&
0.0521,&
0.05504,&
0.0585,&
0.06257,&
0.0673,&
0.0728,&
0.07917,&
0.08652,&
0.09497,&
0.1047,&
0.1158,&
0.1285,&
0.1431,&
0.1597,&
0.1786,&
0.2003,&
0.225,&
0.2532,&
0.2854,&
0.3222,&
0.3643,&
0.4123,&
0.4673,&
0.5303,&
0.6025,&
0.6855,&
0.7811,&
0.8914,&
1.019,&
1.167,&
1.34,&
1.544,&
1.786,&
2.078,&
2.437,&
2.89,&
3.463,&
4.143,&
4.838,&
5.44,&
5.915,&
6.282,&
6.579,&
6.836,&
7.073,&
7.304,&
7.539,&
7.785,&
8.048,&
8.334,&
8.65,&
9.004,&
9.406,&
9.866,&
10.4,&
11.02,&
11.76,&
12.64,&
13.69,&
14.96,&
16.5,&
18.39,&
20.7,&
23.54,&
27.,&
31.24,&
36.39,&
42.65,&
50.27,&
59.59,&
71.04,&
85.28,&
103.1,&
125.9/)

muTable(1,:) = EnergyTable(1,:)

muTable(2,:) =(/2.512E+025,&
2.511E+025,&
2.511E+025,&
2.51E+025,&
2.509E+025,&
2.508E+025,&
2.507E+025,&
2.505E+025,&
2.503E+025,&
2.5E+025,&
2.496E+025,&
2.49E+025,&
2.484E+025,&
2.475E+025,&
2.464E+025,&
2.451E+025,&
2.434E+025,&
2.413E+025,&
2.388E+025,&
2.357E+025,&
2.322E+025,&
2.281E+025,&
2.234E+025,&
2.181E+025,&
2.123E+025,&
2.059E+025,&
1.99E+025,&
1.918E+025,&
1.842E+025,&
1.763E+025,&
1.683E+025,&
1.602E+025,&
1.521E+025,&
1.44E+025,&
1.361E+025,&
1.283E+025,&
1.208E+025,&
1.135E+025,&
1.065E+025,&
9.985E+024,&
9.348E+024,&
8.742E+024,&
8.17E+024,&
7.629E+024,&
7.12E+024,&
6.642E+024,&
6.193E+024,&
5.774E+024,&
5.381E+024,&
5.015E+024,&
4.674E+024,&
4.357E+024,&
4.063E+024,&
3.79E+024,&
3.537E+024,&
3.304E+024,&
3.09E+024,&
2.895E+024,&
2.718E+024,&
2.56E+024,&
2.422E+024,&
2.305E+024,&
2.215E+024,&
2.158E+024,&
2.135E+024,&
2.136E+024,&
2.148E+024,&
2.162E+024,&
2.175E+024,&
2.187E+024,&
2.198E+024,&
2.208E+024,&
2.219E+024,&
2.23E+024,&
2.243E+024,&
2.258E+024,&
2.275E+024,&
2.295E+024,&
2.318E+024,&
2.344E+024,&
2.375E+024,&
2.411E+024,&
2.451E+024,&
2.499E+024,&
2.549E+024,&
2.607E+024,&
2.666E+024,&
2.729E+024,&
2.79E+024,&
2.844E+024,&
2.889E+024,&
2.922E+024,&
2.939E+024,&
2.938E+024,&
2.922E+024,&
2.892E+024,&
2.851E+024,&
2.805E+024,&
2.756E+024,&
2.712E+024/)

IF (Density.GT.0.) THEN
    ReducedElectricField=1.e21*ElectricField/Density ! E/n in Townsend as defined in LXCAT database
    mu = InterpolateCoefficient(muTable,ReducedElectricField)/Density ! table gives mu*n
    D = InterpolateCoefficient(EnergyTable,ReducedElectricField)*mu ! table gives energy=D/mu
    ! (actually not energy but kT/e so eV is already SI here)
END IF

END SUBROUTINE CalcDriftDiffusionCoeffHe

SUBROUTINE CalcIonizationRateNe(ElectricField,Density,ionRate)
!==================================================================================================================================
!> Calculate the transport (drift & diffusion) coefficients for the drift-diffusion electron fluid model
! LXCat BOLSIG+ Neon
! Townsend ioniz. coef. alpha/N (m2)
!==================================================================================================================================
! MODULES
USE MOD_PreProc ! PP_N
! IMPLICIT VARIABLE HANDLING
IMPLICIT NONE
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT VARIABLES
REAL,INTENT(IN)                                  :: ElectricField, Density
!-----------------------------------------------------------------------------------------------------------------------------------
! OUTPUT VARIABLES
REAL,INTENT(OUT)                                 :: ionRate
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT / OUTPUT VARIABLES
!-----------------------------------------------------------------------------------------------------------------------------------
! LOCAL VARIABLES
REAL                                             :: Table(2,100), ReducedElectricField
!===================================================================================================================================

Table(1,:) = (/0.0001,&
0.0001177,&
0.0001385,&
0.000163,&
0.0001918,&
0.0002257,&
0.0002656,&
0.0003126,&
0.0003678,&
0.0004329,&
0.0005094,&
0.0005995,&
0.0007055,&
0.0008302,&
0.000977,&
0.00115,&
0.001353,&
0.001592,&
0.001874,&
0.002205,&
0.002595,&
0.003054,&
0.003594,&
0.004229,&
0.004977,&
0.005857,&
0.006893,&
0.008111,&
0.009545,&
0.01123,&
0.01322,&
0.01556,&
0.01831,&
0.02154,&
0.02535,&
0.02984,&
0.03511,&
0.04132,&
0.04863,&
0.05722,&
0.06734,&
0.07925,&
0.09326,&
0.1097,&
0.1292,&
0.152,&
0.1789,&
0.2105,&
0.2477,&
0.2915,&
0.343,&
0.4037,&
0.4751,&
0.5591,&
0.6579,&
0.7743,&
0.9112,&
1.072,&
1.262,&
1.485,&
1.748,&
2.057,&
2.42,&
2.848,&
3.352,&
3.944,&
4.642,&
5.462,&
6.428,&
7.565,&
8.902,&
10.48,&
12.33,&
14.51,&
17.07,&
20.09,&
23.64,&
27.83,&
32.75,&
38.54,&
45.35,&
53.37,&
62.8,&
73.91,&
86.97,&
102.4,&
120.5,&
141.7,&
166.8,&
196.3,&
231.,&
271.9,&
319.9,&
376.5,&
443.1,&
521.4,&
613.6,&
722.1,&
849.8,&
1000./)

Table(2,:) = (/0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
0.,&
1.116E-35,&
2.159E-33,&
1.373E-31,&
3.821E-30,&
5.845E-29,&
5.583E-28,&
3.746E-27,&
1.898E-26,&
7.678E-26,&
2.571E-25,&
7.377E-25,&
1.859E-24,&
4.203E-24,&
8.66E-24,&
1.649E-23,&
2.935E-23,&
4.93E-23,&
7.881E-23,&
1.207E-22,&
1.782E-22,&
2.548E-22,&
3.547E-22,&
4.822E-22,&
6.423E-22,&
8.405E-22,&
1.083E-21,&
1.375E-21,&
1.723E-21,&
2.135E-21,&
2.616E-21,&
3.173E-21,&
3.809E-21,&
4.528E-21,&
5.33E-21,&
6.211E-21,&
7.165E-21,&
8.177E-21,&
9.228E-21,&
1.029E-20,&
1.133E-20,&
1.231E-20/)

IF (Density.GT.0.) THEN
  ReducedElectricField=1.e21*ElectricField/Density ! E/n in Townsend as defined in LXCAT database
  ionRate = InterpolateCoefficient(Table,ReducedElectricField)*Density !Townsend ioniz. coef. alpha/N (m2)
END IF

END SUBROUTINE CalcIonizationRateNe

SUBROUTINE CalcDriftDiffusionCoeffNe(ElectricField,Density,mu,D)
!==================================================================================================================================
!> Calculate the transport (drift & diffusion) coefficients for the drift-diffusion electron fluid model
! LXCat BOLSIG+ Neon
!==================================================================================================================================
! MODULES
USE MOD_PreProc ! PP_N
! IMPLICIT VARIABLE HANDLING
IMPLICIT NONE
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT VARIABLES
REAL,INTENT(IN)                                  :: ElectricField, Density
!-----------------------------------------------------------------------------------------------------------------------------------
! OUTPUT VARIABLES
REAL,INTENT(OUT)                                 :: mu, D
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT / OUTPUT VARIABLES
!-----------------------------------------------------------------------------------------------------------------------------------
! LOCAL VARIABLES
REAL                                             :: EnergyTable(2,100), muTable(2,100), ReducedElectricField
!===================================================================================================================================
mu= 0.
D = 0.

EnergyTable(1,:) = (/0.0001,&
0.0001177,&
0.0001385,&
0.000163,&
0.0001918,&
0.0002257,&
0.0002656,&
0.0003126,&
0.0003678,&
0.0004329,&
0.0005094,&
0.0005995,&
0.0007055,&
0.0008302,&
0.000977,&
0.00115,&
0.001353,&
0.001592,&
0.001874,&
0.002205,&
0.002595,&
0.003054,&
0.003594,&
0.004229,&
0.004977,&
0.005857,&
0.006893,&
0.008111,&
0.009545,&
0.01123,&
0.01322,&
0.01556,&
0.01831,&
0.02154,&
0.02535,&
0.02984,&
0.03511,&
0.04132,&
0.04863,&
0.05722,&
0.06734,&
0.07925,&
0.09326,&
0.1097,&
0.1292,&
0.152,&
0.1789,&
0.2105,&
0.2477,&
0.2915,&
0.343,&
0.4037,&
0.4751,&
0.5591,&
0.6579,&
0.7743,&
0.9112,&
1.072,&
1.262,&
1.485,&
1.748,&
2.057,&
2.42,&
2.848,&
3.352,&
3.944,&
4.642,&
5.462,&
6.428,&
7.565,&
8.902,&
10.48,&
12.33,&
14.51,&
17.07,&
20.09,&
23.64,&
27.83,&
32.75,&
38.54,&
45.35,&
53.37,&
62.8,&
73.91,&
86.97,&
102.4,&
120.5,&
141.7,&
166.8,&
196.3,&
231.,&
271.9,&
319.9,&
376.5,&
443.1,&
521.4,&
613.6,&
722.1,&
849.8,&
1000./)

EnergyTable(2,:) =(/0.03805,&
0.03812,&
0.03821,&
0.03832,&
0.03847,&
0.03867,&
0.03893,&
0.03926,&
0.03967,&
0.04019,&
0.04084,&
0.04163,&
0.0426,&
0.04376,&
0.04516,&
0.04683,&
0.04882,&
0.05115,&
0.05388,&
0.05706,&
0.06073,&
0.06497,&
0.06982,&
0.07535,&
0.08165,&
0.0888,&
0.0969,&
0.1061,&
0.1164,&
0.1281,&
0.1413,&
0.1561,&
0.173,&
0.192,&
0.2135,&
0.2379,&
0.2656,&
0.297,&
0.333,&
0.3739,&
0.4208,&
0.4746,&
0.5364,&
0.6079,&
0.6907,&
0.7868,&
0.8986,&
1.029,&
1.181,&
1.357,&
1.562,&
1.798,&
2.07,&
2.382,&
2.737,&
3.14,&
3.599,&
4.116,&
4.693,&
5.296,&
5.83,&
6.215,&
6.454,&
6.6,&
6.7,&
6.781,&
6.86,&
6.946,&
7.042,&
7.153,&
7.281,&
7.429,&
7.598,&
7.791,&
8.011,&
8.26,&
8.54,&
8.855,&
9.208,&
9.603,&
10.04,&
10.54,&
11.09,&
11.71,&
12.42,&
13.21,&
14.11,&
15.14,&
16.31,&
17.66,&
19.2,&
20.99,&
23.06,&
25.47,&
28.29,&
31.63,&
35.6,&
40.38,&
46.18,&
53.28/)

muTable(1,:) = EnergyTable(1,:)

muTable(2,:) =(/3.112E+026,&
3.097E+026,&
3.077E+026,&
3.051E+026,&
3.02E+026,&
2.981E+026,&
2.935E+026,&
2.88E+026,&
2.817E+026,&
2.746E+026,&
2.666E+026,&
2.578E+026,&
2.484E+026,&
2.383E+026,&
2.277E+026,&
2.168E+026,&
2.055E+026,&
1.941E+026,&
1.826E+026,&
1.712E+026,&
1.599E+026,&
1.488E+026,&
1.38E+026,&
1.276E+026,&
1.177E+026,&
1.082E+026,&
9.933E+025,&
9.098E+025,&
8.318E+025,&
7.594E+025,&
6.925E+025,&
6.307E+025,&
5.739E+025,&
5.218E+025,&
4.743E+025,&
4.309E+025,&
3.914E+025,&
3.555E+025,&
3.229E+025,&
2.934E+025,&
2.666E+025,&
2.425E+025,&
2.206E+025,&
2.008E+025,&
1.83E+025,&
1.67E+025,&
1.524E+025,&
1.393E+025,&
1.273E+025,&
1.164E+025,&
1.064E+025,&
9.724E+024,&
8.879E+024,&
8.101E+024,&
7.384E+024,&
6.722E+024,&
6.113E+024,&
5.553E+024,&
5.045E+024,&
4.616E+024,&
4.316E+024,&
4.159E+024,&
4.1E+024,&
4.084E+024,&
4.078E+024,&
4.069E+024,&
4.05E+024,&
4.021E+024,&
3.982E+024,&
3.934E+024,&
3.879E+024,&
3.816E+024,&
3.746E+024,&
3.672E+024,&
3.592E+024,&
3.508E+024,&
3.421E+024,&
3.329E+024,&
3.234E+024,&
3.136E+024,&
3.035E+024,&
2.931E+024,&
2.826E+024,&
2.718E+024,&
2.608E+024,&
2.497E+024,&
2.385E+024,&
2.273E+024,&
2.162E+024,&
2.052E+024,&
1.945E+024,&
1.842E+024,&
1.743E+024,&
1.65E+024,&
1.563E+024,&
1.482E+024,&
1.408E+024,&
1.341E+024,&
1.282E+024,&
1.229E+024/)

IF (Density.GT.0.) THEN
    ReducedElectricField=1.e21*ElectricField/Density ! E/n in Townsend as defined in LXCAT database
    mu = InterpolateCoefficient(muTable,ReducedElectricField)/Density ! table gives mu*n
    D = InterpolateCoefficient(EnergyTable,ReducedElectricField)*mu ! table gives energy=D/mu
    ! (actually not energy but kT/e so eV is already SI here)
END IF

END SUBROUTINE CalcDriftDiffusionCoeffNe

SUBROUTINE CalcIonizationRateAr(ElectricField,Density,ionRate)
!==================================================================================================================================
!> Calculate the transport (drift & diffusion) coefficients for the drift-diffusion electron fluid model
!> SPECIES: e / Ar
!PROCESS: Reduced ionization coefficient (alpha/N)
!COMMENT: Jelenak et al 1993 - updated in June 2013.
!UPDATED: 2013-06-02 23:37:30
!COLUMNS: Reduced electric field (Td) | Reduced Townsend coefficient (m2)
!==================================================================================================================================
! MODULES
USE MOD_PreProc ! PP_N
! IMPLICIT VARIABLE HANDLING
IMPLICIT NONE
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT VARIABLES
REAL,INTENT(IN)                                  :: ElectricField, Density
!-----------------------------------------------------------------------------------------------------------------------------------
! OUTPUT VARIABLES
REAL,INTENT(OUT)                                 :: ionRate
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT / OUTPUT VARIABLES
!-----------------------------------------------------------------------------------------------------------------------------------
! LOCAL VARIABLES
REAL                                             :: Table(2,37), ReducedElectricField
!===================================================================================================================================

Table(1,:) = (/75.17727,&
67.7002,&
82.84268,&
89.90082,&
99.70235,&
115.7767,&
121.0711,&
128.3994,&
138.4517,&
145.7108,&
160.5681,&
169.2028,&
186.4555,&
211.5943,&
251.1031,&
256.6163,&
300.2819,&
311.6157,&
380.8278,&
462.449,&
486.6954,&
641.3601,&
670.689,&
744.7624,&
1048.851,&
1454.628,&
1902.25,&
2412.499,&
2720.331,&
3607.785,&
3663.521,&
3885.269,&
5042.057,&
5429.855,&
5937.817,&
7598.191,&
8811.933/)

Table(2,:) = (/3.19E-22,&
3.48E-22,&
5.93E-22,&
7.07E-22,&
8.5E-22,&
1.15E-21,&
1.23E-21,&
1.44E-21,&
1.55E-21,&
1.83E-21,&
1.92E-21,&
2.29E-21,&
2.39E-21,&
3.19E-21,&
3.96E-21,&
4.23E-21,&
5.04E-21,&
5.4E-21,&
6.69E-21,&
8.36E-21,&
7.97E-21,&
1.1E-20,&
1.22E-20,&
1.21E-20,&
1.59E-20,&
2.13E-20,&
2.41E-20,&
2.53E-20,&
2.71E-20,&
2.77E-20,&
3.23E-20,&
2.71E-20,&
2.97E-20,&
2.77E-20,&
2.91E-20,&
2.51E-20,&
2.24E-20/)

IF (Density.GT.0.) THEN
  ReducedElectricField=1.e21*ElectricField/Density ! E/n in Townsend as defined in LXCAT database
  ionRate = InterpolateCoefficient(Table,ReducedElectricField)*Density
END IF

END SUBROUTINE CalcIonizationRateAr

SUBROUTINE CalcDriftDiffusionCoeffAr(ElectricField,Density,mu,D)
!==================================================================================================================================
!> Calculate the transport (drift & diffusion) coefficients for the drift-diffusion electron fluid model
!> SPECIES: e / Ar
! PROCESS: Characteristic energy (D/mu)
! COMMENT: Kucukarpaci et al 1981(DL/mu).
! UPDATED: 2012-12-11 14:17:51
! COLUMNS: Reduced electric field (Td) | Energy (eV)
!> SPECIES: e / Ar
! PROCESS: Mobility x gas density (muN)
! COMMENT: Kucukarpaci et al 1981.
! UPDATED: 2012-12-11 14:14:53
! COLUMNS: Reduced electric field (Td) | Mobility x gas density ((m.V.s)-1)
!==================================================================================================================================
! MODULES
USE MOD_PreProc ! PP_N
! IMPLICIT VARIABLE HANDLING
IMPLICIT NONE
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT VARIABLES
REAL,INTENT(IN)                                  :: ElectricField, Density
!-----------------------------------------------------------------------------------------------------------------------------------
! OUTPUT VARIABLES
REAL,INTENT(OUT)                                 :: mu, D
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT / OUTPUT VARIABLES
!-----------------------------------------------------------------------------------------------------------------------------------
! LOCAL VARIABLES
REAL                                             :: EnergyTable(2,12), muTable(2,13), ReducedElectricField
!===================================================================================================================================
mu= 0.
D = 0.

EnergyTable(1,:) = (/4.1571,&
5.3995,&
6.7691,&
8.4758,&
13.801,&
19.149,&
27.73,&
55.308,&
138.3,&
276.17,&
411.83,&
579.84/)

EnergyTable(2,:) =(/1.3749,&
2.0809,&
3.3331,&
4.0022,&
4.0412,&
4.2424,&
4.2424,&
4.5852,&
5.2446,&
6.2365,&
6.8062,&
7.1449/)



muTable(1,:) =(/2.7322,&
4.2337,&
5.5209,&
6.9518,&
8.5551,&
13.846,&
19.957,&
27.377,&
54.591,&
139.74,&
274.65,&
410.46,&
559.02/)

muTable(2,:) =(/1.4509E+024,&
1.0737E+024,&
1.1223E+024,&
9.733E+023,&
9.3242E+023,&
1.0513E+024,&
1.0338E+024,&
1.0089E+024,&
8.9659E+023,&
7.8357E+023,&
7.1341E+023,&
7.1749E+023,&
6.9164E+023/)

IF (Density.GT.0.) THEN
    ReducedElectricField=1.e21*ElectricField/Density ! E/n in Townsend as defined in LXCAT database
    mu = InterpolateCoefficient(muTable,ReducedElectricField)/Density ! table gives mu*n
    D = InterpolateCoefficient(EnergyTable,ReducedElectricField)*mu ! table gives energy=D/mu
    ! (actually not energy but kT/e so eV is already SI here)
END IF

END SUBROUTINE CalcDriftDiffusionCoeffAr

SUBROUTINE CalcDriftDiffusionCoeffH2(ElectricField,Density,mu,D)
!==================================================================================================================================
!> Calculate the transport (drift & diffusion) coefficients for the drift-diffusion electron fluid model
!> Now using data for electrons in H2 gas from LXCat database (Klaus Berkhan, PhD thesis, 1994, University Heidelberg)
!==================================================================================================================================
! MODULES
USE MOD_PreProc ! PP_N
! IMPLICIT VARIABLE HANDLING
IMPLICIT NONE
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT VARIABLES
REAL,INTENT(IN)                                  :: ElectricField, Density
!-----------------------------------------------------------------------------------------------------------------------------------
! OUTPUT VARIABLES
REAL,INTENT(OUT)                                 :: mu, D
!-----------------------------------------------------------------------------------------------------------------------------------
! INPUT / OUTPUT VARIABLES
!-----------------------------------------------------------------------------------------------------------------------------------
! LOCAL VARIABLES
REAL                                             :: EnergyTable(2,26), muTable(2,56), ReducedElectricField
!===================================================================================================================================
mu= 0.
D = 0.

EnergyTable(1,:) = (/0.04, &
0.05, &
0.06, &
0.07, &
0.08, &
0.1, &
0.12, &
0.14, &
0.17, &
0.2, &
0.25, &
0.3, &
0.35, &
0.4, &
0.5, &
0.6, &
0.7, &
0.8, &
1., &
1.2, &
1.4, &
1.7, &
2., &
2.5, &
3., &
3.5/)

EnergyTable(2,:) =(/0.026, &
0.0258, &
0.0256, &
0.0261, &
0.026, &
0.0263, &
0.0268, &
0.0272, &
0.0278, &
0.0287, &
0.03, &
0.0314, &
0.0334, &
0.0342, &
0.0366, &
0.0388, &
0.0417, &
0.045, &
0.0488, &
0.0546, &
0.0596, &
0.0678, &
0.0763, &
0.0923, &
0.1071, &
0.1208/)

muTable(1,:) =(/0.008, &
0.01, &
0.012, &
0.014, &
0.017, &
0.02, &
0.025, &
0.03, &
0.035, &
0.04, &
0.05, &
0.06, &
0.07, &
0.08, &
0.1, &
0.12, &
0.14, &
0.17, &
0.2, &
0.25, &
0.3, &
0.35, &
0.4, &
0.5, &
0.6, &
0.7, &
0.8, &
1., &
1.2, &
1.4, &
1.7, &
2., &
2.5, &
3., &
3.5, &
4., &
5., &
6., &
7., &
8., &
10., &
12., &
14., &
17., &
20., &
25., &
30., &
35., &
40., &
45., &
50., &
55., &
60., &
65., &
70., &
71./)

muTable(2,:) =(/1.53625E+025, &
1.536E+025, &
1.5325E+025, &
1.53E+025, &
1.52412E+025, &
1.5185E+025, &
1.5096E+025, &
1.49833E+025, &
1.48886E+025, &
1.473E+025, &
1.4518E+025, &
1.42517E+025, &
1.40114E+025, &
1.3775E+025, &
1.332E+025, &
1.29083E+025, &
1.25357E+025, &
1.20235E+025, &
1.157E+025, &
1.0908E+025, &
1.03367E+025, &
9.83714E+024, &
9.39E+024, &
8.626E+024, &
7.985E+024, &
7.44571E+024, &
6.98E+024, &
6.222E+024, &
5.62917E+024, &
5.15357E+024, &
4.60118E+024, &
4.1825E+024, &
3.682E+024, &
3.32933E+024, &
3.07143E+024, &
2.857E+024, &
2.5678E+024, &
2.33E+024, &
2.18229E+024, &
2.06025E+024, &
1.8658E+024, &
1.705E+024, &
1.60179E+024, &
1.47988E+024, &
1.396E+024, &
1.274E+024, &
1.18923E+024, &
1.1072E+024, &
1.1146E+024, &
1.0898E+024, &
1.09736E+024, &
1.09038E+024, &
1.13938E+024, &
1.16058E+024, &
1.26347E+024, &
1.26347E+024/)

IF (Density.GT.0.) THEN
    ReducedElectricField=1.e21*ElectricField/Density ! E/n in Townsend as defined in LXCAT database
    mu = InterpolateCoefficient(muTable,ReducedElectricField)/Density ! table gives mu*n
    D = InterpolateCoefficient(EnergyTable,ReducedElectricField)*mu! table gives energy=D/mu
    ! (actually not energy but kT/e so eV is already SI here)
END IF

END SUBROUTINE CalcDriftDiffusionCoeffH2

PPURE REAL FUNCTION InterpolateCoefficient(CoeffData,ReducedElectricField)
!===================================================================================================================================
!> Interpolate the collision coefficient [m^2] from the available data at the given electric field [J]
!> Collision energies below and above the given data will be set at the first and last level of the data set
!> Note: Requires the data to be sorted by ascending energy values
!> Assumption: First species given is the particle species, second species input is the background gas species
!===================================================================================================================================
! MODULES
IMPLICIT NONE
! INPUT VARIABLES
!-----------------------------------------------------------------------------------------------------------------------------------
REAL,INTENT(IN)               :: CoeffData(:,:)                    !< Array for the interpolation [1:2,1:MaxDOF]
REAL,INTENT(IN)               :: ReducedElectricField                 !< electric field in [J]
!-----------------------------------------------------------------------------------------------------------------------------------
! LOCAL VARIABLES
INTEGER                       :: iDOF, MaxDOF
!===================================================================================================================================

InterpolateCoefficient = 0.
MaxDOF = SIZE(CoeffData,2)

IF(ReducedElectricField.GT.CoeffData(1,MaxDOF)) THEN
  ! If the electric field is greater than the maximal value, extrapolate from the last two values
  IF((MaxDOF.LT.2).OR.(CoeffData(2,MaxDOF).LE.0.))THEN
    ! If only one value is given or the last coefficient is zero
    InterpolateCoefficient = CoeffData(2,MaxDOF)
  ELSE
    ! Extrapolate
    InterpolateCoefficient = CoeffData(2,MaxDOF-1) + (ReducedElectricField - CoeffData(1,MaxDOF-1)) &
                            / (CoeffData(1,MaxDOF) - CoeffData(1,MaxDOF-1)) * (CoeffData(2,MaxDOF) - CoeffData(2,MaxDOF-1))
    ! Check if extrapolation drops under zero
    IF(InterpolateCoefficient.LE.0.) InterpolateCoefficient = 0.
  END IF ! (MaxDOF.LT.2).OR.(CoeffData(2,MaxDOF).LE.0.)
  ! Leave routine
  RETURN
ELSE IF(ReducedElectricField.LE.CoeffData(1,1)) THEN
  ! If electric field is below the minimal value, get the coefficient of the first level and leave routine
  InterpolateCoefficient = CoeffData(2,1)
  ! Leave routine
  RETURN
END IF

DO iDOF = 1, MaxDOF
  ! Check if the stored energy value is above the electric field
  IF(CoeffData(1,iDOF).GT.ReducedElectricField) THEN
    ! Interpolate the coefficient from the data set using the current and the energy level below
    InterpolateCoefficient = CoeffData(2,iDOF-1) + (ReducedElectricField  - CoeffData(1,iDOF-1)) &
                              / (CoeffData(1,iDOF) - CoeffData(1,iDOF-1)) * (CoeffData(2,iDOF) - CoeffData(2,iDOF-1))
    ! Leave routine and do not finish DO loop
    RETURN
  ELSE IF(ReducedElectricField.EQ.CoeffData(1,iDOF)) THEN
    ! In case the electric field is exactly the stored value
    InterpolateCoefficient = CoeffData(2,iDOF)
  END IF
END DO

END FUNCTION InterpolateCoefficient


END MODULE MOD_Transport_Data
