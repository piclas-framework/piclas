! =============================================================================== !
! EQUATION (linearscalaradvection)
! =============================================================================== !
IniExactFunc  = 900 ! 900: 1D + no volume source term as this is done by particles
DoCalcErrorNorms = T
OutputErrorNormsToH5 = T

! =============================================================================== !
! DISCRETIZATION
! =============================================================================== !
N     = 2 ! Polynomial degree
NVisu = 2 ! Number of visualization points
VisuParticles = T

! =============================================================================== !
! MESH
! =============================================================================== !
MeshFile      = 1D_mortonZ_48_mesh.h5
useCurveds    = F

! =============================================================================== !
! OUTPUT / VISUALIZATION
! =============================================================================== !
ProjectName = 1D

! =============================================================================== !
! ANALYZE
! =============================================================================== !
IterDisplayStep     = 1
Part-AnalyzeStep    = 1
Field-AnalyzeStep   = 1
Surface-AnalyzeStep = 1

PIC-OutputSource = T

CalcTemp         = T
CalcNumDens      = T
CalcNumSpec      = T
CalcElectricTimeDerivative = T

CalcBoundaryParticleOutput = T
BPO-NPartBoundaries        = 2       ! Nbr of boundaries
BPO-PartBoundaries         = (/1,2/) ! Part-Boundary1 and Part-Boundary2
BPO-NSpecies               = 1       ! Nbr of species
BPO-Species                = (/1/)   ! electrons

! =============================================================================== !
! CALCULATION
! =============================================================================== !
ManualTimeStep = 2e-11
tend           = 20.0e-10
Analyze_dt     = 1e-10

! =============================================================================== !
! Field boundary conditions
! =============================================================================== !
! Change boundary condition on wall from Neumann to Dirichlet with Phi = 0 V
BoundaryName = BC_RIGHT
BoundaryType = (/6,1/)                 ! Dirichlet with ExactFunc + Nbr of RefState (5: +-, 6: always positive)
RefState     = (/ -10.0 , 0.0 , 0.0 /) ! RefState Nbr 1: Voltage, Frequency and Phase shift

!! FPC
!BoundaryName = BC_DIELECTRIC
!BoundaryType = (/20,1/) ! 20: activate FPC, 2: Group #1


! =============================================================================== !
! Dielectric
! =============================================================================== !
!DoDielectric          = T
!DielectricEpsR        = 10.0
!!DielectricEpsR        = 10000.0
!DielectricMuR         = 1.0
!xyzDielectricMinMax   = (/-1.0,0.0,-1.0,1.0,-1.0,1.0/) !
!!xyzDielectricMinMax   = (/-1.0,10000.0e-9,-1.0,1.0,-1.0,1.0/) !
!
!DielectricNoParticles = F

! =============================================================================== !
! Virtual Dielectric Layer
! =============================================================================== !
PIC-DoDirichletDeposition      = F ! default is True
PIC-Deposition-Type            = 12 ! cell_volweight_mean (12)
Part-Boundary1-PermittivityVDL = 10.
Part-Boundary1-ThicknessVDL    = 10.0e-9

!pAdaptionType=2 ! 2: set boundary elements to NMax

! =============================================================================== !
! HDG
! =============================================================================== !
PrecondType = 0
epsCG       = 1e-9

! =============================================================================== !
! PARTICLES
! =============================================================================== !

Part-nSpecies          = 2
Part-maxParticleNumber = 120000

! =============================================================================== !
! PARTICLE BOUNDARIES
! =============================================================================== !
Part-FIBGMdeltas = (/ 1.000010e-3 , 0.05e-3 , 0.05e-3 /)
Part-FactorFIBGM = (/ 100         , 1       , 1    /)

Part-nBounds           = 6

Part-Boundary1-SourceName = BC_LEFT
Part-Boundary1-Condition  = reflective

Part-Boundary2-SourceName = BC_RIGHT
Part-Boundary2-Condition  = open

Part-Boundary3-SourceName = BC_periodicy+
Part-Boundary3-Condition  = periodic

Part-Boundary4-SourceName = BC_periodicy-
Part-Boundary4-Condition  = periodic

Part-Boundary5-SourceName = BC_periodicz+
Part-Boundary5-Condition  = periodic

Part-Boundary6-SourceName = BC_periodicz-
Part-Boundary6-Condition  = periodic

Part-nPeriodicVectors = 2

! =============================================================================== !
! Species1
! =============================================================================== !
Part-Species1-ChargeIC            = -1.602176634e-19
Part-Species1-MassIC              = 9.1093826e-31
Part-Species1-MacroParticleFactor = 1.560377269e-2

Part-Species1-nInits = 1 ! 1

Part-Species1-Init1-SpaceIC              = cuboid
Part-Species1-Init1-velocityDistribution = maxwell_lpn
Part-Species1-Init1-MWTemperatureIC      = 11604.
Part-Species1-Init1-ParticleNumber       = 100000
Part-Species1-Init1-BasePointIC          = (/0. , 0.   , 0./)
Part-Species1-Init1-BaseVector1IC        = (/0. , 5e-5 , 0./)
Part-Species1-Init1-BaseVector2IC        = (/0. , 0.   , 5e-5/)
Part-Species1-Init1-NormalIC             = (/1. , 0.   , 0./)
Part-Species1-Init1-CuboidHeightIC       = 1e-3
!Part-Species1-Init1-CuboidHeightIC       = 0.00099
Part-Species1-Init1-VeloIC               = 0.
Part-Species1-Init1-VeloVecIC            = (/0.,1.,0./)

! =============================================================================== !
! Species2
! =============================================================================== !
Part-Species2-ChargeIC            = 2.5e-11 ! calculated to acquire sigma = 1e-2 C/m2
Part-Species2-MassIC              = 1.0 ! make super heavy
Part-Species2-MacroParticleFactor = 1e-4 ! why is it 4x1.0e-4 for the NodeSourceExt deposition?

Part-Species2-nInits = 1

Part-Species2-Init1-SpaceIC              = cuboid
Part-Species2-Init1-velocityDistribution = maxwell_lpn
Part-Species2-Init1-MWTemperatureIC      = 50000.0
Part-Species2-Init1-ParticleNumber       = 10000

Part-Species2-Init1-BasePointIC          = (/20000e-9 , 0.   , 0./)

Part-Species2-Init1-BaseVector1IC        = (/0. , 5e-5 , 0./)
Part-Species2-Init1-BaseVector2IC        = (/0. , 0.   , 5e-5/)
Part-Species2-Init1-NormalIC             = (/1. , 0.   , 0./)
Part-Species2-Init1-CuboidHeightIC       = 1e-15
Part-Species2-Init1-VeloIC               = 1e6
Part-Species2-Init1-VeloVecIC            = (/-1.,0.,0./)



